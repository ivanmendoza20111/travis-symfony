language: php
# sudo: false
php:
    - 7.1

env:
  - .env

services:
  - mysql

before_install:
  - composer self-update
  # - if [ "$DEPENDENCIES" == "dev" ]; then perl -pi -e 's/^}$/,"minimum-stability":"dev"}/' composer.json; fi;
  # - if [ "$SYMFONY_VERSION" != "" ]; then composer --no-update require symfony/symfony:${SYMFONY_VERSION}; fi;

install: 
  - composer install

script:
  - php bin/console doctrine:schema:update --dump-sql
  - php bin/console doctrine:schema:update -f
  - phpunit
  - 'if [ "$TRAVIS_PULL_REQUEST" != "false" ]; then bash ./travis/run_on_pull_requests; fi'
  - 'if [ "$TRAVIS_PULL_REQUEST" = "false" ]; then bash ./travis/run_on_non_pull_requests; fi'

after_success:
  - ./travis_merge_script.sh

# notifications:
#   email: ivanmendoza2011@hotmail.com
  # slack:
  #   on_success: always
  #   on_failure: change
  #   rooms:
  #     secure: generated-secret